---
title: 系统加固
date: 2023-03-24 12:52:09
permalink: /pages/f768ee/
categories:
  - Linux
  - 系统管理
tags:
  - 
---

# 账号和口令
## 禁用或删除无用账号

> 减少系统无用账号，降低安全风险。

为了降低安全风险，我们需要禁用或删除不必要的账号。这里提供两种方法：使用命令`userdel <用户名>`删除不必要的账号，或者使用命令`passwd -l <用户名>`锁定不必要的账号。如果需要解锁必要的账号，则使用命令`passwd -u <用户名>`即可。请注意，在执行任何操作之前，请确保已经备份了相关的数据。


## 检查特殊账号

> 检查是否存在空口令和root权限的账号。

为了确保系统安全，我们需要定期检查特殊账号。具体来说，我们需要检查是否存在空口令和root权限的账号。使用命令`awk -F: '($2=="")' /etc/shadow`可以查看空口令账号，而使用命令 `awk -F: '($3==0)' /etc/passwd`则可以查看UID为零的账号。如果发现异常账号，请尽快删除或锁定这些账号。


## 加固空口令账号

> 使用命令`passwd <用户名>`为空口令账号设定密码。确认`UID`为零的账号只有`root`账号。

空口令账号是很容易被攻击的一个漏洞点，为了加强安全性，我们需要对这些账号进行加固。可以使用命令`passwd <用户名>`给空口令账号设定密码。同时，我们需要确认系统中UID为零的账号只有`root`账号。如果发现其他账号也具有UID为零的权限，则需要尽快限制这些账号的权限。


## 添加口令策略

> 加强口令的复杂度等，降低被猜解的可能性。

为了降低安全风险，我们需要添加口令策略。可以使用命令`vi /etc/login.defs`修改配置文件，设置新建用户的密码最长使用天数、最短使用天数和到期提前提醒天数。例如，可以将`PASS_MAX_DAYS`设置为90，`PASS_MIN_DAYS`设置为0，`PASS_WARN_AGE`设置为7。另外，可以使用命令`chage`修改用户的设置，如将此用户的密码最长使用天数设为30，最短使用天数设为0，密码2000年1月1日过期，过期前七天警告用户。最后，可以设置连续输错三次密码，账号锁定五分钟，使用命令`vi /etc/pam.d/common-auth`修改配置文件，在配置文件中添加`auth required pam_tally.so onerr=fail deny=3 unlock_time=300`。


## 限制用户su

> 限制能`su`到`root`的用户。

为了防止恶意攻击者使用`su`命令获取root权限，我们需要限制能够进行`su`操作的用户。可以使用命令`vi /etc/pam.d/su`修改配置文件，在配置文件中添加相应的行。例如，如果只允许`test`组的用户进行`su`操作，则添加`auth required pam_wheel.so group=test`。


## 禁止root用户直接登录

> 限制`root`用户直接登录。

为了增强安全性，我们需要限制`root`用户直接登录。具体来说，可以创建一个普通权限账号并配置密码，防止无法远程登录。然后，使用命令`vi /etc/ssh/sshd_config`修改配置文件，将`PermitRootLogin`的值改成`no`，并保存。最后，使用`service sshd restart`重启服务使修改生效。


# 服务

## 关闭不必要的服务

> 关闭不必要的服务（如普通服务和xinetd服务），降低风险。

为了降低安全风险，我们需要关闭一些不必要的服务。可以使用命令`systemctl disable <服务名>`设置服务在开机时不自动启动。注意，在执行任何操作之前，请确保已经备份了相关的数据。对于部分老版本的Linux操作系统（如CentOS 6），可以使用命令`chkconfig --level <服务名> off`设置服务在指定`init`级别下开机时不自动启动。


## SSH服务安全

> 对SSH服务进行安全加固，防止暴力破解成功。

为了防止SSH服务遭受暴力破解，我们需要进行安全加固。可以使用命令`vim /etc/ssh/sshd_config`编辑配置文件，具体操作如下：

- 不允许`root`账号直接登录系统。设置`PermitRootLogin`的值为`no`。
- 修改`SSH`使用的协议版本。设置`Protocol`的版本为`2`。
- 修改允许密码错误次数（默认6次）。设置`MaxAuthTries`的值为`3`。

配置文件修改完成后，重启`sshd`服务使其生效。


## 定期更新系统和应用程序

> 定期更新系统和应用程序，修复漏洞和提高安全性。

为了保证系统安全性，我们需要定期更新系统和应用程序。可以使用命令`yum update`更新软件包到最新版本。同时，在安装任何新软件之前，请确保该软件是来自可信的源，否则可能会导致系统受到攻击。另外，还可以使用命令`yum upgrade`升级所有已经安装的软件包到最新版本。这样可以修复已知漏洞并提高系统安全性。

